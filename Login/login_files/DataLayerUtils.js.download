var DataLayerUtils=function(){function e(){}return e.logSearchGa4Event=function(t){var s=t.inputSelector,o=t.event,n=$(s).val();n!==e.dataTableSearch&&typeof dataLayer!="undefined"&&dataLayer.push({event:o}),e.dataTableSearch=n},e.attachDataLayerClickEvents=function(){$("*[data-datalayer-clickevent]:not(.datalayer-clickeventbound)").addClass("datalayer-clickeventbound").on("click",function(){var e=$(this).attr("data-datalayer-clickevent");typeof e!="undefined"&&e&&dataLayer.push({event:e})})},e.addDomEvents=function(e,t,n){n===void 0&&(n="");var s=function(e){var n=$(e).attr(t);typeof dataLayer!="undefined"&&typeof n!="undefined"&&n&&dataLayer.push({event:n})};$(n+" ["+t+"]:not(."+t+")").addClass(""+t).on(e,function(e){s(e.target)})},e.addCommonEvents=function(){e.addDomEvents("click","data-datalayer-click"),e.addDomEvents("focus","data-datalayer-focus")},e.setupDataTablePagingEvent=function(e,t){var n,o,a=e.first,r=e.last,c=e.page,l=e.ellipsePrev,d=e.ellipseNext,s=e.containerSelector,u=e.tableLength,i=e.footerButtons;if(t===void 0&&(t=!0),!s){console.warn("parent container selector wasn't set.");return}a&&(n=t?".first button.page-link":".dataTables_paginate a.first",$(s).on("click",n,function(){typeof dataLayer!="undefined"&&dataLayer.push({event:a})})),r&&(n=t?".last button.page-link":".dataTables_paginate a.last",$(s).on("click",n,function(){typeof dataLayer!="undefined"&&dataLayer.push({event:r})})),c&&(n=t?".page-number button.page-link":".dataTables_paginate a.page-number",$(s).on("click",n,function(e){typeof dataLayer!="undefined"&&dataLayer.push({event:c,page_number:e.currentTarget.textContent})})),l&&(n=t?".ellipses-prev button.page-link":".dataTables_paginate a.ellipses-prev",$(s).on("click",n,function(){typeof dataLayer!="undefined"&&dataLayer.push({event:l})})),d&&(n=t?".ellipses-next button.page-link":".dataTables_paginate a.ellipses-next",$(s).on("click",n,function(){typeof dataLayer!="undefined"&&dataLayer.push({event:d})})),u&&$(s).on("focus",".dataTables_length select",function(){typeof dataLayer!="undefined"&&dataLayer.push({event:u})});for(o=0;o<i.length;o++)h(o);function h(e){i[e]&&$(s).on("click",".DTTT_container a:nth-of-type("+(e+1)+")",function(){typeof dataLayer!="undefined"&&dataLayer.push({event:i[e]})})}},e.setupModalEvents=function(e){var n=e.containerSelector,t=e.events,o=e.modalSelector,s=o===void 0?"":o;if(!n)return;t?.footerCloseButton&&$(n).on("click",s+" .modal-footer [type='button']",function(){typeof dataLayer!="undefined"&&dataLayer.push({event:t.footerCloseButton})}),t?.headerCloseButton&&$(n).on("click",s+" .modal-header button.close",function(){typeof dataLayer!="undefined"&&dataLayer.push({event:t.headerCloseButton})}),t?.modalBackground&&$(n).on("click",s+".modal",function(e){e.target.classList.contains("modal")&&typeof dataLayer!="undefined"&&dataLayer.push({event:t.modalBackground})}),t?.modalOpened&&$(n+"  modalSelector+.modal").on("shown.bs.modal",function(){typeof dataLayer!="undefined"&&dataLayer.push({event:t.modalOpened})}),$(n+" .modal").on("hidden.bs.modal",function(){$(n).off("click",".modal-header button.close"),$(n).off("click",".modal-footer [type='button']"),$(n).off("click",".modal")})},e.getUserDataFromCache=function(e){if(typeof sessionStorage=="undefined")return null;var t=sessionStorage.getItem(e);return t?JSON.parse(t):null},e.cacheUserData=function(e,t){e?sessionStorage.setItem(t,JSON.stringify(e)):console.warn("No user data provided to cache.")},e.fetchAndPushUserData=function(){var n,s="userDataCache",t=e.getUserDataFromCache(s);if(t&&isUserLoggedIn!==(((n=t?.attributes)===null||n===void 0?void 0:n.user_id)==null)){typeof dataLayer!="undefined"&&dataLayer.push(t);return}$.ajax({url:"/mvc/ga4/userdata",method:"GET",dataType:"json",success:function(t){t&&t.event&&t.attributes&&(typeof dataLayer!="undefined"&&dataLayer.push(t),e.cacheUserData(t,s))},error:function(e,t,n){console.error("Failed to fetch user data:",t,n)}})},e.dataTableSearch="",e}();runWhenReady(DataLayerUtils.fetchAndPushUserData),runWhenReady(DataLayerUtils.attachDataLayerClickEvents),runWhenReady(DataLayerUtils.addCommonEvents)